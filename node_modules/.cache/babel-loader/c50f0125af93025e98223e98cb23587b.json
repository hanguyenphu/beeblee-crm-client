{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Ha Nguyen\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\Ha Nguyen\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Ha Nguyen\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\Ha Nguyen\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\Ha Nguyen\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\Ha Nguyen\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import{Modal,Button,Row,TextInput,Select}from\"react-materialize\";import Loading from\"../loading/Loading\";import ContactForm from\"../contact/ContactForm\";import{ContactTable}from\"../contact/ContactTable\";import API from\"../../utils/API/API\";import formatPhone from\"../../utils/commons/FormatPhone\";import ProvinceDropdown from\"../common/ProvinceDropdown\";import BusinessForm from\"./BusinessForm\";var BusinessModalDetail=/*#__PURE__*/function(_Component){_inherits(BusinessModalDetail,_Component);function BusinessModalDetail(props){var _this;_classCallCheck(this,BusinessModalDetail);_this=_possibleConstructorReturn(this,_getPrototypeOf(BusinessModalDetail).call(this,props));_this.handleChangeBusiness=function(e){var field=e.target.name;var value=e.target.value;if(field===\"phone\"){value=formatPhone(value);}var business=_this.state.business;business[field]=value;_this.setState(_objectSpread({},_this.state,{business:business,edited:true}));};_this.updateBusiness=function(e){e.preventDefault();var _id=_this.state.business._id;var business={name:_this.state.business.name,phone:_this.state.business.phone,address:_this.state.business.address,province:_this.state.business.province};_this.setState({errorMessage:\"\",successMessage:\"\",loading:true,edited:false});API.patch(\"businesses/\".concat(_id),business).then(function(response){//Update the data in the parent component\n_this.props.updateData();_this.setState(_objectSpread({},_this.state,{successMessage:\"Save successfully!\",loading:false}));}).catch(function(error){_this.setState({errorMessage:\"Cannot save the data!\",loading:false});});};_this.addMoreContactToTable=function(contact){var contacts=_this.state.contacts;contacts.push(contact);_this.setState(_objectSpread({},_this.state,{contacts:contacts}));};_this.state={edited:false};return _this;}_createClass(BusinessModalDetail,[{key:\"componentDidMount\",value:function componentDidMount(){this.setState({business:this.props.business});this.getBusinessDetail(this.props.business._id);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.business._id!==this.props.business._id){this.getBusinessDetail(this.props.business._id);this.setState({business:this.props.business,errorMessage:\"\",successMessage:\"\",edited:false});}}},{key:\"getBusinessDetail\",value:function getBusinessDetail(id){var _this2=this;this.setState(_objectSpread({},this.state,{loading:true}));API.get(\"businesses/\".concat(id)).then(function(response){if(response.data.business){_this2.setState(_objectSpread({},_this2.state,{contacts:response.data.business.contacts,province:response.data.business.province,loading:false}));}}).catch(function(err){_this2.setState({loading:false,errorMessage:\"Could not fetch the data\"});});}},{key:\"render\",value:function render(){var contacts=this.state.contacts||[];if(!this.state.business){return React.createElement(Loading,null);}var business=this.state.business;return React.createElement(Modal,{actions:[React.createElement(Button,{flat:true,modal:\"close\",node:\"button\",waves:\"green\"},\"Close\")],open:true,style:{boder:\"none\"},bottomSheet:false,fixedFooter:true,header:\"Business Detail\",id:\"modal1\",required:true,options:{dismissible:true,endingTop:\"10%\",inDuration:250,onCloseEnd:null,onCloseStart:null,onOpenEnd:null,onOpenStart:null,opacity:0.5,outDuration:250,preventScrolling:true,startingTop:\"4%\"}},!this.state.loading?React.createElement(\"div\",null,React.createElement(BusinessForm,{business:business,updateData:this.props.updateData}),React.createElement(Row,{className:\"animated fadeInUp\"},React.createElement(\"h5\",null,\"Contacts \"),React.createElement(ContactForm,{business:business,addMoreContactToTable:this.addMoreContactToTable})),React.createElement(ContactTable,{contacts:contacts,business:business})):React.createElement(Loading,null));}}]);return BusinessModalDetail;}(Component);var mapStateToProps=function mapStateToProps(state){return{provinces:state.provinces};};var mapDispatchToProps={};export default connect(mapStateToProps,mapDispatchToProps)(BusinessModalDetail);","map":{"version":3,"sources":["C:/xampp/htdocs/beeblee-crm-client/src/features/business/BusinessModalDetail.jsx"],"names":["React","Component","connect","Modal","Button","Row","TextInput","Select","Loading","ContactForm","ContactTable","API","formatPhone","ProvinceDropdown","BusinessForm","BusinessModalDetail","props","handleChangeBusiness","e","field","target","name","value","business","state","setState","edited","updateBusiness","preventDefault","_id","phone","address","province","errorMessage","successMessage","loading","patch","then","response","updateData","catch","error","addMoreContactToTable","contact","contacts","push","getBusinessDetail","prevProps","id","get","data","err","boder","dismissible","endingTop","inDuration","onCloseEnd","onCloseStart","onOpenEnd","onOpenStart","opacity","outDuration","preventScrolling","startingTop","mapStateToProps","provinces","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Modal, Button, Row, TextInput, Select } from \"react-materialize\";\r\nimport Loading from \"../loading/Loading\";\r\n\r\nimport ContactForm from \"../contact/ContactForm\";\r\nimport { ContactTable } from \"../contact/ContactTable\";\r\nimport API from \"../../utils/API/API\";\r\nimport formatPhone from \"../../utils/commons/FormatPhone\";\r\nimport ProvinceDropdown from \"../common/ProvinceDropdown\";\r\nimport BusinessForm from \"./BusinessForm\";\r\n\r\n\r\n\r\nclass BusinessModalDetail extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      edited: false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setState({\r\n      business: this.props.business\r\n    });\r\n    this.getBusinessDetail(this.props.business._id);\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.business._id !== this.props.business._id) {\r\n      this.getBusinessDetail(this.props.business._id);\r\n      this.setState({\r\n        business: this.props.business,\r\n        errorMessage: \"\",\r\n        successMessage: \"\",\r\n        edited: false\r\n      });\r\n    }\r\n  }\r\n\r\n  getBusinessDetail(id) {\r\n    this.setState({\r\n      ...this.state,\r\n      loading: true\r\n    });\r\n    API.get(`businesses/${id}`)\r\n      .then(response => {\r\n        if (response.data.business) {\r\n          this.setState({\r\n            ...this.state,\r\n            contacts: response.data.business.contacts,\r\n            province: response.data.business.province,\r\n            loading: false\r\n          });\r\n        }\r\n      })\r\n      .catch(err => {\r\n        this.setState({\r\n          loading: false,\r\n          errorMessage: \"Could not fetch the data\"\r\n        });\r\n      });\r\n  }\r\n\r\n  handleChangeBusiness = e => {\r\n    const field = e.target.name;\r\n    let value = e.target.value;\r\n    if (field === \"phone\") {\r\n      value = formatPhone(value);\r\n    }\r\n    let business = this.state.business;\r\n    business[field] = value;\r\n    this.setState({\r\n      ...this.state,\r\n      business,\r\n      edited: true\r\n    });\r\n  };\r\n\r\n  updateBusiness = e => {\r\n    e.preventDefault();\r\n    const _id = this.state.business._id;\r\n    const business = {\r\n      name: this.state.business.name,\r\n      phone: this.state.business.phone,\r\n      address: this.state.business.address,\r\n      province: this.state.business.province\r\n    };\r\n    this.setState({\r\n      errorMessage: \"\",\r\n      successMessage: \"\",\r\n      loading: true,\r\n      edited: false\r\n    });\r\n\r\n    API.patch(`businesses/${_id}`, business)\r\n      .then(response => {\r\n        //Update the data in the parent component\r\n        this.props.updateData();\r\n        this.setState({\r\n          ...this.state,\r\n          successMessage: \"Save successfully!\",\r\n          loading: false\r\n        });\r\n      })\r\n      .catch(error => {\r\n        this.setState({\r\n          errorMessage: \"Cannot save the data!\",\r\n          loading: false\r\n        });\r\n      });\r\n  };\r\n\r\n  addMoreContactToTable = contact => {\r\n    let contacts = this.state.contacts;\r\n    contacts.push(contact);\r\n    this.setState({\r\n      ...this.state,\r\n      contacts\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const contacts = this.state.contacts || [];\r\n    if (!this.state.business) {\r\n      return <Loading />;\r\n    }\r\n    const { business } = this.state;\r\n    return (\r\n      <Modal\r\n        actions={[\r\n          <Button flat modal=\"close\" node=\"button\" waves=\"green\">\r\n            Close\r\n          </Button>\r\n        ]}\r\n        open={true}\r\n        style={{ boder: \"none\" }}\r\n        bottomSheet={false}\r\n        fixedFooter={true}\r\n        header=\"Business Detail\"\r\n        id=\"modal1\"\r\n        required\r\n        options={{\r\n          dismissible: true,\r\n          endingTop: \"10%\",\r\n          inDuration: 250,\r\n          onCloseEnd: null,\r\n          onCloseStart: null,\r\n          onOpenEnd: null,\r\n          onOpenStart: null,\r\n          opacity: 0.5,\r\n          outDuration: 250,\r\n          preventScrolling: true,\r\n          startingTop: \"4%\"\r\n        }}\r\n      >\r\n        {!this.state.loading ? (\r\n          <div>\r\n\r\n            <BusinessForm business={business} updateData={this.props.updateData}/>\r\n\r\n\r\n            <Row className=\"animated fadeInUp\">\r\n              <h5>Contacts </h5>\r\n              <ContactForm\r\n                business={business}\r\n                addMoreContactToTable={this.addMoreContactToTable}\r\n              />\r\n            </Row>\r\n            <ContactTable contacts={contacts} business={business} />\r\n          </div>\r\n        ) : (\r\n          <Loading />\r\n        )}\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return { provinces: state.provinces };\r\n};\r\n\r\nconst mapDispatchToProps = {};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(BusinessModalDetail);\r\n"]},"metadata":{},"sourceType":"module"}